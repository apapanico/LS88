<!DOCTYPE html>
<html>
  <head><meta charset="utf-8" />

    
    

    <title></title><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.js"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.0/dist/bootstrap-toc.min.css">  
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
    <link rel="stylesheet" href="/LS88/assets/css/style.css">
    <link rel="stylesheet" href="/LS88/assets/css/table.css">
    <link rel="stylesheet" href="/LS88/assets/css/ipy_base.css">
    <link rel="stylesheet" href="/LS88/assets/css/ipy_nb.css">
    <link rel="stylesheet" href="/LS88/assets/css/ipy_tree.css">
    <link rel="stylesheet" href="/LS88/assets/css/ipy_syntax.css">


    <!-- Loading mathjax macro -->
    <!-- Load mathjax -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
    <!-- MathJax configuration -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    <!-- End of mathjax configuration --></head>
    <body>
      
      <!--Navigation bar-->
      
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
	<a class="navbar-brand" href="/LS88/index.html">LS88 - Sports Analytics</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
	<span class="navbar-toggler-icon"></span>
	</button>
	<div class="collapse navbar-collapse" id="navbarSupportedContent">
		<ul class="navbar-nav mr-auto">
			<li class="nav-item">
				<a class="nav-link" href="/LS88/syllabus.html">Syllabus</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/LS88/demos.html">Demos</a>
			</li>
			<!-- <li class="nav-item dropdown">
				<a class="nav-link dropdown-toggle" data-toggle="dropdown">HW</a>
				<div class="dropdown-menu">
					<a class="dropdown-item" href="#">Data8 Review</a>
					<a class="dropdown-item" href="#">Baseball Statistics</a>
					<a class="dropdown-item" href="#">4th Down Bot</a>
				</div>
			</li>
			<li class="nav-item">
				<a class="nav-link" href="/LS88/lectures.html">Lectures</a>
			</li> -->
		</ul>
	</div>
</nav>
      <!--end of Navigation bar-->
      
      <div id="bodyContent">
        <div class="container" id="main-container">
          <div class="row">
            <div class="col-2">
                <nav id="toc" data-toggle="toc" class="sticky-top"></nav>
            </div>
            <div class="col-10">
              <div tabindex="-1" id="notebook" class="border-box-sizing">
                <div class="container" id="notebook-container" data-spy="scroll" data-target="#toc">
                  
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">hot_hand_helper</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>

<span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2018</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Hot-Hand">The Hot Hand<a class="anchor-link" href="#The-Hot-Hand">&#182;</a></h1><p>The notion of a hot hand is often considered to be a cognitive fallacy, an error in our brains that ascribes more meaning to a random sequence of shots than we rightly should.  People have taken many different approaches to this topic and shis demo shows how one can use statistical testing tools to test the existence of the hot hand effect in basketball.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Did-Klay-Thompson-have-a-Hot-Hand?">Did Klay Thompson have a Hot Hand?<a class="anchor-link" href="#Did-Klay-Thompson-have-a-Hot-Hand?">&#182;</a></h2><p>Let's take a look at Klay Thompson's shooting performance from Dec. 5, 2016 versus the Indiana Pacers.  Klay scored 60 points in 29 minutes of playing time, an unprecedented level of output in such a short amount of time.</p>
<p>A couple of quick facts:</p>
<ul>
<li>Klay took 33 total shots and 14 three-pointers</li>
<li>He made 21 of his total shots, 8 of which were 3s (that means he made 10 FTs)</li>
</ul>
<p>The first thing we look at Klay's sequence of shot results.  We represent this as a string of 0s and 1s (1s representing a make, naturally).  We want to test whether Klay's "hot handedness" led to abnormal results in his shooting.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">klay60</span> <span class="o">=</span> <span class="s1">&#39;110111100101111110010101110010101&#39;</span>

<span class="n">klay60_num_shots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">klay60</span><span class="p">)</span>
<span class="n">klay60_num_makes</span> <span class="o">=</span> <span class="n">num_matches</span><span class="p">(</span><span class="n">klay60</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">klay60_fgpct</span> <span class="o">=</span> <span class="n">klay60_num_makes</span> <span class="o">/</span> <span class="n">klay60_num_shots</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">FGM: </span><span class="si">{klay60_num_makes}</span><span class="s2"></span>
<span class="s2">FGA: </span><span class="si">{klay60_num_shots}</span><span class="s2"></span>
<span class="s2">FG%: </span><span class="si">{klay60_fgpct:.3f}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
FGM: 21
FGA: 33
FG%: 0.636

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hypotheses">Hypotheses<a class="anchor-link" href="#Hypotheses">&#182;</a></h3><p>Our <em>null hypothesis</em>: <strong>there is no hot hand effect</strong>.</p>
<p>Why do we choose this as the null hypothesis?  The standard approach in testing is to start with the assumption that an effect does not exist and work to try to provide evidence that it does.  For drugs or treatments, this means you start with the assumption that the drug or treatment has no effect on patient outcomes and gather data to show that the drug has a <em>statistically significant</em> impact on outcomes.</p>
<p>In our case, we will use data to gather evidence to show that the hot hand effect exists.  We do this by building <em>test statistics</em> that we use to try to reject the null hypothesis in favor an <em>alternative hypothesis</em>: the alternative hypothesis <strong>there is a hot hand effect</strong>.</p>
<h3 id="Test-Statistics">Test Statistics<a class="anchor-link" href="#Test-Statistics">&#182;</a></h3><p>Okay, we know our null and alternative hypotheses.  But how do we test them?  How do we even quantify what we think the hot hand effect might be?</p>
<p>In some cases, it is obvious what you need to test for.  For drug outcomes, we can directly tie outcome to an important and measurable variable and demonstrate that the drug has a positive impact on that measured variable.</p>
<p>The hot hand does not seem to have one fixed, uniform definition but is rather like the way Justice Potter Stewart referred to obscenity: I know it when I see it.  That's not good enough here so we're going to try a few things.  The first is looking at streaks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Our-First-Test-Statistic:-Longest-Streak">Our First Test Statistic: Longest Streak<a class="anchor-link" href="#Our-First-Test-Statistic:-Longest-Streak">&#182;</a></h4><p>First, we're going to look at Klay's longest streak to see if it's longer than we should expect.  His longest stretch of makes was 6 shots.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">klay60_streak</span> <span class="o">=</span> <span class="n">longest_streak</span><span class="p">(</span><span class="n">klay60</span><span class="p">)</span>
<span class="n">klay60_streak</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[3]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>6</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Distribution-of-Longest-Streak">Distribution of Longest Streak<a class="anchor-link" href="#Distribution-of-Longest-Streak">&#182;</a></h5><p>Now that we know Klay's longest streak was 6 makes, we need to know how 6 stacks up as a streak compared to a player similar to Klay but who definitely does not have a hot hand effect.  That is, we need to compute the distribution of the statistics assuming the null hypothesis, where there is no hot hand, is the proper model.  The distribution of the statistic when assuming the null hypothesis is sometimes called the <em>null distribution</em>.</p>
<p>How do we create such a player?  One way is by modeling our null player's shots as the result of <em>weighted coin flips</em>.  A weighted coin flip is a coin flip where instead of a 50-50 chance of coming up heads, the coin will come up head with some prescribed probability $p$.  We take the probability as equal to Klay's shooting perentage and the number of heads we get from one simulation will be Klay's made field goal attempts.</p>
<p>Another important consideration is how many times to flip the coin.  We use the total number of shot's Klay took in the game.  Why?  We want to match the simulated player to Klay and the number of shots taken plays an important role in how likely we are to see certain phenomenon.</p>
<p>We use a function called <code>coin_flips</code> to simulate the weighted coin flips to determine how many shots a player like Klay makes in a single simulation.  We then create a random shuffling of the makes and misses and compute the longest streak of makes.  Finally, we plot the histogram.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_permutations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay_fgpct</span> <span class="o">=</span> <span class="o">.</span><span class="mi">463</span>

<span class="n">streaks_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_permutations</span><span class="p">):</span>
    <span class="c1"># Simulate the coin flips</span>
    <span class="n">fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">n_flips</span><span class="o">=</span><span class="n">klay60_num_shots</span><span class="p">,</span> <span class="n">prob_heads</span><span class="o">=</span><span class="n">klay_fgpct</span><span class="p">)</span>
    <span class="c1"># Shuffle the shots</span>
    <span class="n">klay60_shuffled</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">fgm</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">klay60_num_shots</span> <span class="o">-</span> <span class="n">fgm</span><span class="p">))</span>
    <span class="c1"># Compute the longest streak</span>
    <span class="n">streak_shuff</span> <span class="o">=</span> <span class="n">longest_streak</span><span class="p">(</span><span class="n">klay60_shuffled</span><span class="p">)</span>
    <span class="n">streaks_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">streak_shuff</span><span class="p">)</span>

<span class="n">streaks_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">streaks_null</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we look at the histogram, we find that Klay's streak of 6 is really not that uncommon for a player like him. About 15% of simulations produced a streak at least as long as 6.  As of now, other than the raw totals (perhaps due just to increase shots taken), Klay's performance does not look extraordinary.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">streaks_null</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Streak distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay60_streak</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed streak&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Our-Second-Test-Statistic:-Shooting-Percentage">Our Second Test Statistic: Shooting Percentage<a class="anchor-link" href="#Our-Second-Test-Statistic:-Shooting-Percentage">&#182;</a></h4><p>This is easy.  We're going to test the shooting percentage if he was hot for the whole game instead of for a long streak.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay_fgpct</span> <span class="o">=</span> <span class="o">.</span><span class="mi">463</span>

<span class="n">klay_fgpct_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
    <span class="c1"># Simulate the coin flips</span>
    <span class="n">fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">n_flips</span><span class="o">=</span><span class="n">klay60_num_shots</span><span class="p">,</span> <span class="n">prob_heads</span><span class="o">=</span><span class="n">klay_fgpct</span><span class="p">)</span>
    <span class="c1"># Compute shooting percentage</span>
    <span class="n">klay_fgpct_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fgm</span> <span class="o">/</span> <span class="n">klay60_num_shots</span><span class="p">)</span>
    
<span class="n">klay_fgpct_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">klay_fgpct_null</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Distribution-of-Shooting-Percentage">Distribution of Shooting Percentage<a class="anchor-link" href="#Distribution-of-Shooting-Percentage">&#182;</a></h5><p>Naturally the observed shooting percentage for a random player will center around the expected shooting percentage. Interestingly, Klay's shooting percetage is in the top ~4% among the simulations, so that's kind of extreme.  Maybe Klay has nights where he's feeling great and shoots really well.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">klay_fgpct_null</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FG</span><span class="si">% d</span><span class="s1">istribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay_fgpct</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Klay 2016 FG%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay60_fgpct</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Klay 60pt Game FG%&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Another-Test-Statistic:-NBA-Jam-On-Fire">Another Test Statistic: NBA Jam On Fire<a class="anchor-link" href="#Another-Test-Statistic:-NBA-Jam-On-Fire">&#182;</a></h4><p>Another way to quantify the hot hand is using a well-known approach proposed by Amos Tversky and his collaborators.  The hot hand of Tversky is similar to the notion of being "on fire" in the old arcade game NBA Jam.  In that game, if you made 3 shots in a row with a player, your player would be on fire (animated flames would denote this).  While on fire (until a miss), the player had an inflated probability of making shots.</p>
<p>The statistic to capture this affect, called $T_{k, hit}$, is easy to compute:
\begin{align*}
  T_{k, hit}
  &amp; = \mathrm{Prob}(\text{Make $k+1$ shots in a row}\ \mathit{GIVEN}\ \text{Already made $k$ shots in a row})\\
  &amp; = \frac{\#\{\text{Streaks of $k+1$ makes in a row}\}}{\#\{\text{Streaks of $k$ makes in a row}\}}
\end{align*}
If $T_{k, hit}$ is especially high, then the player could experience a hot hand.</p>
<p>A similar statistic can try to capture a cold hand:
\begin{align*}
  T_{k, miss}
  &amp; = \mathrm{Prob}(\text{Make $k+1$-st shot}\ \mathit{GIVEN}\ \text{Already missed $k$ shots in a row})\\
  &amp; = \frac{\#\{\text{Streak of $k$ misses followed by make}\}}{\#\{\text{Streaks of $k$ misses in a row}\}}
\end{align*}
If the value of $T_{k, miss}$ is especially high, then the player <em>does not</em> experience a cold hand because he will see reversals in his streaks.</p>
<p>We'll look at $k=2$ but similar results will hold for $k=3$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">T_2_hit</span> <span class="o">=</span> <span class="n">compute_t_k_hit</span><span class="p">(</span><span class="n">klay60</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">T_2_miss</span> <span class="o">=</span> <span class="n">compute_t_k_miss</span><span class="p">(</span><span class="n">klay60</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">T_2_hit:  </span><span class="si">{T_2_hit:.3f}</span><span class="s2"> </span>
<span class="s2">T_2_miss: </span><span class="si">{T_2_miss:.3f}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
T_2_hit:  0.636 
T_2_miss: 1.000

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay, we have two numbers, $T_{k, hit}$ and $T_{k, miss}$.  Without context, they do not mean much.  We know that Klay reversed each of streaks of 2 misses.  And we know he shot 63.6% following streaks of 2.  Of course, he shot 63.6% overall on that day.</p>
<h5 id="Distribution-of-Tversky's-Statistics">Distribution of Tversky's Statistics<a class="anchor-link" href="#Distribution-of-Tversky's-Statistics">&#182;</a></h5><p>We're going to do the same thing as before: we're going to model the player who does not have the hot hand using a weighted coin flip.  The process is identical to the longest streak process.</p>
<p>Note: In the simulated data, sometimes we might not see any streaks of length 2.  In that case, the statistic does not have a valid value so we just ignore that simulation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay_fgpct</span> <span class="o">=</span> <span class="o">.</span><span class="mi">463</span>

<span class="n">T_2_hit_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">T_2_miss_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
    <span class="c1"># Simulate the coin flips</span>
    <span class="n">fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">n_flips</span><span class="o">=</span><span class="n">klay60_num_shots</span><span class="p">,</span> <span class="n">prob_heads</span><span class="o">=</span><span class="n">klay_fgpct</span><span class="p">)</span>
    <span class="c1"># Shuffle the shots</span>
    <span class="n">klay60_shuffled</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">fgm</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">klay60_num_shots</span> <span class="o">-</span> <span class="n">fgm</span><span class="p">))</span>
    <span class="c1"># Compute the statistics</span>
    <span class="n">T_2_hit_shuff</span> <span class="o">=</span> <span class="n">compute_t_k_hit</span><span class="p">(</span><span class="n">klay60_shuffled</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">T_2_miss_shuff</span> <span class="o">=</span> <span class="n">compute_t_k_miss</span><span class="p">(</span><span class="n">klay60_shuffled</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">T_2_hit_shuff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">T_2_hit_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_2_hit_shuff</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">T_2_miss_shuff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">T_2_miss_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">T_2_miss_shuff</span><span class="p">)</span>

<span class="n">T_2_hit_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_2_hit_null</span><span class="p">)</span>
<span class="n">T_2_miss_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">T_2_miss_null</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="Histograms-of-the-null-distributions">Histograms of the null distributions<a class="anchor-link" href="#Histograms-of-the-null-distributions">&#182;</a></h5><p>We recognize that the observation of Tversky's statistic for Klay's 60 pt game was not extraordinary.  For one, his perceived increased ability to extend his shooting streak is within the possibility of random chance.  His ability to reverse his cold streak seems noteworthy in how he was perfect in avoiding missing 3 shots in a row, however given that for the game he shot 63.6%, we already know he's not going to miss many shots and therefore not likely have a prolonged streak of misses.  We'll return to this issue later.</p>
<p>Okay, so maybe there's no streakiness in his shooting.  Maybe he was just feeling it all game and shot a much higher percentage than usual.  We'll test that next.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T_2_hit_null</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T_{2,hit}$ distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">T_2_hit</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed $T_{2,hit}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">T_2_miss_null</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T_{2,miss}$ distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">T_2_miss</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed $T_{2,miss}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Yet-Another-Statistic:-Sum-of-Klay's-Two-Longest-Streak">Yet Another Statistic: Sum of Klay's Two Longest Streak<a class="anchor-link" href="#Yet-Another-Statistic:-Sum-of-Klay's-Two-Longest-Streak">&#182;</a></h4><p>This is similar to the longest streak but maybe Klay doesn't necessarily generate long streaks but has an ability to get on a streak so he generates multiple longish streaks.  We can try to capture this by the length of his two longest streaks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">klay60_two_streaks</span> <span class="o">=</span> <span class="n">longest_two_streaks</span><span class="p">(</span><span class="n">klay60</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">klay60_two_streaks</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So again, Klay's combined value of 10 (streaks of 6 and 4) is also not especially noteworthy.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay_fgpct</span> <span class="o">=</span> <span class="o">.</span><span class="mi">463</span>

<span class="n">two_streaks_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
    <span class="c1"># Simulate the coin flips</span>
    <span class="n">fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">n_flips</span><span class="o">=</span><span class="n">klay60_num_shots</span><span class="p">,</span> <span class="n">prob_heads</span><span class="o">=</span><span class="n">klay_fgpct</span><span class="p">)</span>
    <span class="c1"># Shuffle the shots</span>
    <span class="n">klay60_shuffled</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="o">*</span><span class="n">fgm</span> <span class="o">+</span> <span class="s1">&#39;0&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">klay60_num_shots</span> <span class="o">-</span> <span class="n">fgm</span><span class="p">))</span>
    <span class="c1"># Compute the statistic</span>
    <span class="n">two_streak_shuff</span> <span class="o">=</span> <span class="n">longest_two_streaks</span><span class="p">(</span><span class="n">klay60_shuffled</span><span class="p">)</span>
    <span class="n">two_streaks_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">two_streak_shuff</span><span class="p">)</span>

<span class="n">two_streaks_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">two_streaks_null</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">two_streaks_null</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">17.5</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span>
        <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Streak distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay60_two_streaks</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed streak&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Interpretation-of-the-Results">Interpretation of the Results<a class="anchor-link" href="#Interpretation-of-the-Results">&#182;</a></h3><p>The statistics we produced seem to show that while the game was noteworthy for the volume of shooting and scoring in such a compressed time frame, the actually efficiency numbers were not particularly extraordinary for a player of Klay's ability.</p>
<p>However, we should note a few things:</p>
<ul>
<li>We've lumped together 2s and 3s: if you reran this analysis separating the 2s and 3s, you wouldn't get a different or special view.  Klay shoots about 42% from three so he's already really good and will just have games where the shots fall.</li>
<li>The statistics do seem on the extreme end and we kind of wrote that off saying that they weren't so extreme to convince us Klay had a special night.  In fact, the story is actually a bit more damning for the hot hand as we'll see below.</li>
</ul>
<p>Klay's 60 point game was not one single game but actually just one of many games.  He's had many opportunities to shoot and put up gawdy numbers (~300 since Steve Kerr started coaching for the Warriors).  Given that he's had about 300 opportunities, if we observe a statistic that says it should happen about 1 in 100 times for a random no-hot-hand weighted coin flip player, then it should have happened about 3 times over 300 games.  The fact that Klay has had tons of games in order to put up gawdy numbers means that by picking the most gawdiest, we've accidentally cherry-picked this game and our standard for extremeness needs to be much higher.</p>
<p>Let's actually look at how often Klay has an extreme looking performance and compare to what would be predicted by the weighted coin flip model.</p>
<p>Here are some numbers to put this in context (see cells below for the computation):</p>
<ul>
<li>Klay shot 68.4% on 19 two-point attempts in the 60pt game.  From 2014-15 to 2017-18, he had 21 games where he shot at least 15 2-pt shots and in 1 of those (this 60 pt game) he shot at least 68.4%.  In our coin flip model, using his 2-pt pct of 49% and those 21 games, we'd expect about 1 game shooting at least 68.4%.  </li>
<li>Klay shot 57.1% on 14 three-point attempts in the game.  In that same Kerr-era time span for the Warriors, he had 74 games where he had at least 10 3-pt shot attempts and in 15 of those games he shot at least 57.1% from 3.  In our coin flip model, using his 3-pt pct of 42% and 74 games of 10 3pt attempts, we'd expect about 15 games shooting at least 57.1%.  </li>
</ul>
<p>So even though this game was a bit extreme, it was not that extreme compared to other Klay performances.  And when you factor in how often he plays and has an opportunity to have a gawdy shooting night, his performances match up with what'd you expect from a player shooting with weighted coin flips.</p>
<p>Now, he took 33 shots and it's his only game with at least 29 shots.  That's fairly special but is it really that special given that the team was passing the ball to Klay and allowing him to shoot?  This would be like riding out your luck at a casino game.  You perceive a run of luck and decided to keep playing and while the run may last longer than usual, it wasn't anything but a produce of luck.</p>
<p>The takeaway: Klay's shooting performances for his career are just not out of line with what we expect from our coin flip model.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay60_2fgpct</span> <span class="o">=</span> <span class="mf">0.684</span>
<span class="n">klay_2fgpct</span> <span class="o">=</span> <span class="mf">0.49</span>
<span class="n">klay_2fga</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">n_games</span> <span class="o">=</span> <span class="mi">21</span>

<span class="n">klay_2fgpct_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
    <span class="n">klay_2fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">klay_2fga</span><span class="p">,</span> <span class="n">klay_2fgpct</span><span class="p">)</span>
    <span class="n">klay_2fgpct_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">klay_2fgm</span> <span class="o">/</span> <span class="n">klay_2fga</span><span class="p">)</span>
    
<span class="n">klay_2fgpct_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">klay_2fgpct_null</span><span class="p">)</span>

<span class="n">sims_greater_than_Klay60_2s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">klay_2fgpct_null</span> <span class="o">&gt;=</span> <span class="n">klay60_2fgpct</span><span class="p">))</span>
<span class="n">frac_greater_than_Klay60_2s</span> <span class="o">=</span> <span class="n">sims_greater_than_Klay60_2s</span> <span class="o">/</span> <span class="n">n_simulations</span>
<span class="n">extreme_2pt_games_per_G</span> <span class="o">=</span> <span class="n">frac_greater_than_Klay60_2s</span> <span class="o">*</span> <span class="n">n_games</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Sims more extreme than Klay 60:       </span><span class="si">{sims_greater_than_Klay60_2s}</span><span class="s2"></span>
<span class="s2">Fraction of sims more extreme:        </span><span class="si">{frac_greater_than_Klay60_2s:.2f}</span><span class="s2"></span>
<span class="s2">Extreme 2pt Games per </span><span class="si">{n_games}</span><span class="s2"> Team Games:  </span><span class="si">{extreme_2pt_games_per_G:.2f}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Sims more extreme than Klay 60:       481
Fraction of sims more extreme:        0.05
Extreme 2pt Games per 21 Team Games:  1.01

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">klay60_3fgpct</span> <span class="o">=</span> <span class="mf">0.571</span>
<span class="n">klay_3fgpct</span> <span class="o">=</span> <span class="mf">0.42</span>
<span class="n">klay_3fga</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n_games</span> <span class="o">=</span> <span class="mi">74</span>

<span class="n">klay_3fgpct_null</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_simulations</span><span class="p">):</span>
    <span class="n">klay_3fgm</span> <span class="o">=</span> <span class="n">coin_flips</span><span class="p">(</span><span class="n">klay_3fga</span><span class="p">,</span> <span class="n">klay_3fgpct</span><span class="p">)</span>
    <span class="n">klay_3fgpct_null</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">klay_3fgm</span> <span class="o">/</span> <span class="n">klay_3fga</span><span class="p">)</span>
<span class="n">klay_3fgpct_null</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">klay_3fgpct_null</span><span class="p">)</span>

<span class="n">sims_greater_than_Klay60_3s</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">klay_3fgpct_null</span> <span class="o">&gt;=</span> <span class="n">klay60_3fgpct</span><span class="p">))</span>
<span class="n">frac_greater_than_Klay60_3s</span> <span class="o">=</span> <span class="n">sims_greater_than_Klay60_3s</span> <span class="o">/</span> <span class="n">n_simulations</span>
<span class="n">extreme_3pt_games_per_G</span> <span class="o">=</span> <span class="n">frac_greater_than_Klay60_3s</span> <span class="o">*</span> <span class="n">n_games</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Sims more extreme than Klay 60:       </span><span class="si">{sims_greater_than_Klay60_3s}</span><span class="s2"></span>
<span class="s2">Fraction of sims more extreme:        </span><span class="si">{frac_greater_than_Klay60_3s:.2f}</span><span class="s2"></span>
<span class="s2">Extreme 3pt Games per </span><span class="si">{n_games}</span><span class="s2"> Team Games:  </span><span class="si">{extreme_3pt_games_per_G:.2f}</span><span class="s2"></span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

<div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
Sims more extreme than Klay 60:       1997
Fraction of sims more extreme:        0.20
Extreme 3pt Games per 74 Team Games:  14.78

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Does-Klay-Show-the-Hot-Hand-over-a-Season?">Does Klay Show the Hot Hand over a Season?<a class="anchor-link" href="#Does-Klay-Show-the-Hot-Hand-over-a-Season?">&#182;</a></h2><p>In one of Klay's most stellar games, it appears that any potential hot handedness can be chalked up to luck producing a performance that we as humans think is more extreme or impressive than it actually is.</p>
<p>If Klay really has a hot hand effect, he'll routinely show it over the season.  We can try to detect this by looking at Tversky's statistics but computed across all of Klay's games for a season.  Here's an explanation for the setup:</p>
<ol>
<li>Take all of Klay's 3pt shots in a given year and look at game's 3pt shot sequence.  We restrict to 3pt shots this time because we want to be a bit more judicious about not mixing different shot results which can have drastically different expected make probabilities.</li>
<li>For each game, we compute 4 quantities:
\begin{gather*}
 \#\{\text{Streaks of $k+1$ makes in a row}\},\ 
 \#\{\text{Streaks of $k$ makes in a row}\},\\
 \#\{\text{Streak of $k$ misses followed by make}\},\ 
 \#\{\text{Streaks of $k$ misses in a row}\}
\end{gather*}
for $k=1, 2, 3$.  We add these to running totals for the Klay's season.</li>
<li>To generate the null distribution, we take each game's shot sequence and randomly shuffle it 500 times.  For each shuffling we compute the statistics and add to a set of 500 running totals.  This means we keep the number of shots made the same for each game.  Why do we do this instead of using the weighted coin flip model?  We actually could have done this before for Klay's performance but the conclusions wouldn't have changed.  We're using it now because it's easier to implement but is still useful: we've randomized the sequence of shot results holding the number of makes fixed so we can see if there is anything special in the sequencing.</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data">Data<a class="anchor-link" href="#Data">&#182;</a></h3><p>Producing this data takes a bit of effort so I've gone ahead and done it already and stored it CSV format.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">klay_season_hot_hand</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;klay_season_hot_hand.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">])</span>
<span class="n">klay_season_hot_hand_null</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;klay_season_hot_hand_null.csv.gz&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Null-Distributions">Null Distributions<a class="anchor-link" href="#Null-Distributions">&#182;</a></h3><p>We can look at each year but the conclusion is going to be the same no matter what: there is no strong evidence that there is any hot hand sequencing in Klay's 3pt shooting.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">year</span> <span class="o">=</span> <span class="mi">2016</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">klay_T_3_hit</span> <span class="o">=</span> <span class="n">klay_season_hot_hand</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">year</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="s1">&#39;t_k_hit&#39;</span><span class="p">]</span>
<span class="n">klay_T_3_hit_null</span> <span class="o">=</span> <span class="n">klay_season_hot_hand_null</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">year</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="s1">&#39;t_k_hit&#39;</span><span class="p">]</span>
<span class="n">klay_T_3_miss</span> <span class="o">=</span> <span class="n">klay_season_hot_hand</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">year</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="s1">&#39;t_k_miss&#39;</span><span class="p">]</span>
<span class="n">klay_T_3_miss_null</span> <span class="o">=</span> <span class="n">klay_season_hot_hand_null</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">year</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="s1">&#39;t_k_miss&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Year: </span><span class="si">{year}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">klay_T_3_hit_null</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T_{3,hit}$ distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay_T_3_hit</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed $T_{3,hit}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">klay_T_3_miss_null</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$T_{3,miss}$ distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">klay_T_3_miss</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed $T_{3,miss}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-Easy/Hard-is-it-to-Detect-the-Hot-Hand?">How Easy/Hard is it to Detect the Hot Hand?<a class="anchor-link" href="#How-Easy/Hard-is-it-to-Detect-the-Hot-Hand?">&#182;</a></h2><p>We've worked hard to try to detect the hot hand, but given that we seem to not have found anything, we should wonder, how hard is it to actually detect a hot hand using the statistics we have been using.</p>
<p>To do this, we're going to simulate a hot hand player compared to a non-hot hand player (ie. a weighted coin flip) and compare how the distribution of the statistics to see just how different they are.</p>
<p>The extent that a test statistic can detect an effect is known as <em>statistical power</em> and is incredibly important.  There are three things that drive power: sample size, effect size, quality of the statistic.  We're not dealing with complicated statistics so the last one doesn't really apply.  The first two are always important.</p>
<p>A lot of studies that are reported on in popular press often have tests with very little power and this is often due to small sample sizes.  The importance of power is that if a study has low power but is reporting a result, you should be very suspicious of the result because it's more likely something was done wrong instead of an actual effect being detected.</p>
<h3 id="Simulating-a-Hot-Hand">Simulating a Hot Hand<a class="anchor-link" href="#Simulating-a-Hot-Hand">&#182;</a></h3><p>Inspired by Tversky's statistic, let's simulate a player that should be well estimated by that statistic.  The normal shooting percentage for the player will be .35 while the hot shooting percentage will be .8.  The player will be hot after two makes in a row.  When the player misses, he reverts to normal.  The player starts the game normal.</p>
<p>The seasonal average for this player will be about .45 so that is the shooting percentage we take for the coin flip player.</p>
<p>I chose these values because the difference in shooting between hot and normal is incredibly large.  If we can't detect this, then we're in trouble.</p>
<h3 id="Distributions-of-Statistics">Distributions of Statistics<a class="anchor-link" href="#Distributions-of-Statistics">&#182;</a></h3><h4 id="Hard-to-Detect:-One-game">Hard to Detect: One game<a class="anchor-link" href="#Hard-to-Detect:-One-game">&#182;</a></h4><p>I generated 50,000 "games" where each player took 14 shots and for each game computed Tversky's statistic for $k=2$.</p>
<p>The comparison of the distributions for the hot hand player and the non-hot hand player are as follows:</p>
<p><img src="hot_hand_1.png" alt="hot_hand_1.png"></p>
<p>The way to interpret the histograms is that if we observed a game from a hot hand player, the observed value of the statistic would usually have a value that is entirely plausible from the coin flip player.  This means that it is really hard to distinguish between the hot hand player and the coin flip player.  It's almost assured that we wouldn't be able to detect the hot hand effect.</p>
<p>In an ideal world, the distribution for the hot hand player would be far to the right of the the coin flip player.<br>
So we see that the effect in an individual game is basically impossible to reliably detect.  The next simulations show easier detections.</p>
<h4 id="Easy-to-Detect:-Lots-of-Games">Easy to Detect: Lots of Games<a class="anchor-link" href="#Easy-to-Detect:-Lots-of-Games">&#182;</a></h4><p>This time, I simulated 1000 "seasons" of 82 "games" where each player took 8 shots.</p>
<p><img src="hot_hand_4.png" alt="hot_hand_4.png"></p>
<p>We see that observing the player over the course of a season will yield basically perfect detection for a hot hand effect of this size.</p>
<h4 id="Still-Easy-to-Detect:-Smaller-Effect-Size">Still Easy to Detect: Smaller Effect Size<a class="anchor-link" href="#Still-Easy-to-Detect:-Smaller-Effect-Size">&#182;</a></h4><p>Again I simulated 1000 "seasons" of 82 "games" where each player took 8 shots.  But this time, $p_{hot} = .6$ and $p_{normal} = .42$.  This still corresponds to a seasonal average of about .45.</p>
<p><img src="hot_hand_5.png" alt="hot_hand_5.png"></p>
<p>Even though the effect size is perhaps more reasonable, observing over the course of the season still makes the effect easy to detect.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary-of-the-Hot-Hand">Summary of the Hot Hand<a class="anchor-link" href="#Summary-of-the-Hot-Hand">&#182;</a></h2><p>Here's what we have determined: a player who has a reputation as a streaky shooter actually has shooting performances which are in line with what we'd expect from a simple weighted coin flip model.  They're also in line with randomized shuffling instead of weighted coin flips.</p>
<p>Other studies indicate that recent performance (in baseball, over a 1 week period; in basketball, previous shot attempts) has a small amount predictive power.  In the NBA, an extra make in the previous 4 shots can lead to a 1.2% increase in make percentage.  This demo does not aim to refute those conclusions.</p>
<p>However, ask yourself this: what do <em>you</em> think of when you hear an announcer say a player is hot?  Compare that to the claims of predictive power from recent performance.  The usual mental model of a hot hand effect is likely not a small uptick in percentage but rather one where a player becomes unstoppable when they're hot.  Observed data does not back up our mental model of hot shooting yet when we look at whether it would even be possible over a season to detect a moderate hot hand effect, we see that Tversky's statistic is in fact pretty powerful.</p>
<p>It's quite likely that if the effect were to exist, it would either be fairly small so that Tversky's statistic could not detect it, and thus not particularly consequential.  Or it would be large but more specialized and rare and thus more hidden than how it's conventionally been framed (turns on whenever a shooter makes multiple shots).</p>
<p>This all goes with a general rule of statistics: if an effect really is there and big, you'll know it because it'll show up in the data and practically be punching you in the face to announce it's presence.</p>

</div>
</div>
</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </body>
  
 


</html>
